{% extends "base.html" %}

{% block title %}My Restaurants - JustEat Technology{% endblock %}

{% block extra_css %}
<style>
.page-background {
    position: relative;
    margin: -20px -15px 0 -15px;
    padding: 20px 15px 0 15px;
    min-height: 100vh;
}

.page-background::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.3);
    z-index: 1;
}

.page-background .container {
    position: relative;
    z-index: 2;
}

.page-background .card {
    background-color: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(5px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}
</style>
{% endblock %}

{% block content %}
<div class="page-background" style="background-image: url('{{ url_for('static', filename='images/header-bg.jpg') }}'); background-size: cover; background-position: center; background-attachment: fixed;">
<div class="container py-4">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1 class="display-5 fw-bold">
                        <i class="fas fa-store text-success me-2"></i>My Restaurants
                    </h1>
                    <p class="lead text-muted">Manage your restaurants and menus</p>
                </div>
                <a href="{{ url_for('restaurant.add_restaurant') }}" class="btn btn-success btn-lg">
                    <i class="fas fa-plus me-2"></i>Add Restaurant
                </a>
            </div>
        </div>
    </div>
    
    {% if restaurants %}
    <div class="row g-4">
        {% for restaurant in restaurants %}
        {% set image_map = {
            "Mario's Italian Bistro": "marrio.jpg",
            "Spice Palace": "spice.jpg", 
            "Dragon Wok": "dragon.jpeg",
            "Green Leaf Cafe": "green.jpg",
            "Burger Junction": "burger.jpg",
            "Sushi Zen": "sushi.jpeg",
            "Taco Fiesta": "taco.jpg",
            "Bakery Corner": "bakery.jpg"
        } %}
        {% set restaurant_image = image_map.get(restaurant.name, "bakery.jpg") %}
        <div class="col-lg-6">
            <div class="card border-0 shadow-sm overflow-hidden" style="position: relative; min-height: 250px;">
                <!-- Background Image -->
                <div class="restaurant-bg" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-image: url('{{ url_for('static', filename='images/restaurants/' + restaurant_image) }}'); background-size: cover; background-position: center; z-index: 1;"></div>
                
                <!-- Gradient Overlay -->
                <div class="restaurant-overlay" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(180deg, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.7) 100%); z-index: 2;"></div>
                
                <!-- Content -->
                <div class="card-body d-flex flex-column justify-content-between" style="position: relative; z-index: 3; color: white;">
                    <!-- Top Section -->
                    <div>
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <h5 class="card-title mb-0 text-white fw-bold">{{ restaurant.name }}</h5>
                            <span class="badge" style="background-color: rgba(255,255,255,0.2); color: white; backdrop-filter: blur(10px);">{{ restaurant.cuisine_type }}</span>
                        </div>
                        
                        <p class="card-text mb-3" style="color: rgba(255,255,255,0.9);">{{ restaurant.description }}</p>
                        
                        <div class="row mb-3">
                            <div class="col-6">
                                <small style="color: rgba(255,255,255,0.8);">
                                    <i class="fas fa-map-marker-alt me-1"></i>{{ restaurant.location }}
                                </small>
                            </div>
                            <div class="col-6">
                                <small style="color: rgba(255,255,255,0.8);">
                                    <i class="fas fa-phone me-1"></i>{{ restaurant.phone }}
                                </small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Bottom Section -->
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <span style="color: #ffc107;">
                                {% for i in range(5) %}
                                    <i class="fas fa-star{% if i >= restaurant.rating %}-o{% endif %}"></i>
                                {% endfor %}
                            </span>
                            <small class="ms-1" style="color: rgba(255,255,255,0.8);">({{ restaurant.total_reviews }} reviews)</small>
                        </div>
                        <div>
                            <a href="{{ url_for('restaurant.menu_management', restaurant_id=restaurant.id) }}" 
                               class="btn btn-sm me-2" style="background-color: #85AA4A; border-color: #85AA4A; color: white; box-shadow: 0 2px 8px rgba(133, 170, 74, 0.3);">
                                <i class="fas fa-utensils me-1"></i>Manage Menu
                            </a>
                            <button class="btn btn-sm" style="background-color: rgba(255,255,255,0.2); border-color: rgba(255,255,255,0.3); color: white; backdrop-filter: blur(10px);" onclick="editRestaurant({{ restaurant.id }})">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <!-- No Restaurants -->
    <div class="row">
        <div class="col-12">
            <div class="text-center py-5">
                <i class="fas fa-store text-muted display-1 mb-3"></i>
                <h3 class="text-muted">No restaurants yet</h3>
                <p class="text-muted">Add your first restaurant to start accepting orders!</p>
                <a href="{{ url_for('restaurant.add_restaurant') }}" class="btn btn-success btn-lg">
                    <i class="fas fa-plus me-2"></i>Add Your First Restaurant
                </a>
            </div>
        </div>
    </div>
    {% endif %}
</div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function editRestaurant(restaurantId) {
    // This would open a modal or redirect to edit page
    console.log('Edit restaurant:', restaurantId);
    showToast('info', 'Edit functionality coming soon!');
}
</script>
{% endblock %}
